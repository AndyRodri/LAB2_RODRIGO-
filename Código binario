#include <Arduino.h>

const int ledPins[4] = {23, 22, 16, 4};
const int botonSuma = 17;
const int botonResta = 19;

int contador = 0; // Ahora de 0 a 4 (5 estados)

unsigned long tiempoAnteriorSuma = 0;
unsigned long tiempoAnteriorResta = 0;
const unsigned long debounceDelay = 100;

bool estadoAnteriorSuma = HIGH;
bool estadoAnteriorResta = HIGH;

void mostrarLedUnico(int indice) {
  if (indice >= 0 && indice < 4) {
    for (int i = 0; i < 4; i++) {
      digitalWrite(ledPins[i], (i == indice) ? HIGH : LOW);
    }
    Serial.print("LED activo: ");
    Serial.println(indice + 1);
  } else {
    for (int i = 0; i < 4; i++) {
      digitalWrite(ledPins[i], LOW);
    }
    Serial.println("Todos los LEDs APAGADOS");
  }
}

void setup() {
  for (int i = 0; i < 4; i++) {
    pinMode(ledPins[i], OUTPUT);
    digitalWrite(ledPins[i], LOW);
  }
  pinMode(botonSuma, INPUT_PULLUP);
  pinMode(botonResta, INPUT_PULLUP);
  Serial.begin(115200);
  delay(500);
  mostrarLedUnico(contador);
}

void loop() {
  bool estadoActualSuma = digitalRead(botonSuma);
  bool estadoActualResta = digitalRead(botonResta);
  unsigned long tiempoActual = millis();

  // Antirrebote botón suma
  if (estadoAnteriorSuma == HIGH && estadoActualSuma == LOW) {
    if ((tiempoActual - tiempoAnteriorSuma) > debounceDelay) {
      contador = (contador + 1) % 5; // Ahora 5 estados (0-4)
      Serial.println("Boton Suma PRESIONADO");
      mostrarLedUnico(contador);
      tiempoAnteriorSuma = tiempoActual;
    }
  }
  if (estadoAnteriorSuma != estadoActualSuma) {
    tiempoAnteriorSuma = tiempoActual;
  }
  estadoAnteriorSuma = estadoActualSuma;

  // Antirrebote botón resta
  if (estadoAnteriorResta == HIGH && estadoActualResta == LOW) {
    if ((tiempoActual - tiempoAnteriorResta) > debounceDelay) {
      contador = (contador - 1 + 5) % 5; // Ahora 5 estados (0-4)
      Serial.println("Boton Resta PRESIONADO");
      mostrarLedUnico(contador);
      tiempoAnteriorResta = tiempoActual;
    }
  }
  if (estadoAnteriorResta != estadoActualResta) {
    tiempoAnteriorResta = tiempoActual;
  }
  estadoAnteriorResta = estadoActualResta;
}
